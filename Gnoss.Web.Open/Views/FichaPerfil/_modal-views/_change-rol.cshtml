@model CambiarRolUsuarioViewModel
@{
    List<RolModel> rolesEcosistema = new List<RolModel>();
    List<RolModel> rolesComunidad = new List<RolModel>();
    List<RolHeredado> rolesHeredados = new List<RolHeredado>();
    if (Model != null && Model.Roles != null)
    {
        rolesEcosistema = Model.Roles.Where(x => x.Tipo.Equals((short)AmbitoRol.Ecosistema)).ToList();
        rolesComunidad = Model.Roles.Where(x => x.Tipo.Equals((short)AmbitoRol.Comunidad)).ToList();
        rolesHeredados = Model.RolesHeredados;
    }
}

<div class="modal-header">
    <p class="modal-title"><span class="material-icons">label</span> @Html.GetText("USUARIOS", "CAMBIARROL")</p>
    <span class="material-icons cerrar" data-dismiss="modal" aria-label="Close">close</span>
</div>
<div class="modal-body">
    <div class="formulario-edicion formulario_@Model.IdentidadID">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="ecosistema-tab" data-toggle="tab" href="#ecosistema" role="tab" aria-controls="ecosistema" aria-selected="true">Roles de Ecosistema</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="comunidad-tab" data-toggle="tab" href="#comunidad" role="tab" aria-controls="comunidad" aria-selected="false">Roles de Comunidad</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="heredado-tab" data-toggle="tab" href="#heredado" role="tab" aria-controls="heredado" aria-selected="false">Roles heredados</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade show active" id="ecosistema" role="tabpanel" aria-labelledby="ecosistema-tab">
                @foreach (RolModel rol in rolesEcosistema)
                {
                    <div class="form-group">
                        <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input" id="@rol.RolID" @(Model.RolesYaTiene.Contains(rol.RolID) ? "checked" : "") />
                            <label class="custom-control-label" for="@rol.RolID">@rol.Nombre</label>
                            <small class="form-text text-muted">@rol.Descripcion</small>
                        </div>
                    </div>
                }
            </div>
            <div class="tab-pane fade" id="comunidad" role="tabpanel" aria-labelledby="comunidad-tab">
                @foreach (RolModel rol in rolesComunidad)
                {
                    <div class="form-group">
                        <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input" id="@rol.RolID" @(Model.RolesYaTiene.Contains(rol.RolID) ? "checked" : "") />
                            <label class="custom-control-label" for="@rol.RolID">@rol.Nombre</label>
                            <small class="form-text text-muted">@rol.Descripcion</small>
                            
                        </div>
                    </div>
                }
            </div>

            <div class="tab-pane fade" id="heredado" role="tabpanel" aria-labelledby="heredado-tab">
                @if (rolesHeredados != null && rolesHeredados.Any())
                {
                    foreach (RolHeredado rol in rolesHeredados)
                    {
                        <div class="form-group">
                            <div>
                                <label>@rol.Nombre</label>
                                <small class="form-text text-muted">@rol.Descripcion</small>
                                <small class="form-text text-muted">@rol.GrupoOrigen</small>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="alert alert-info" role="alert">
                        <i class="fas fa-info-circle"></i> No hay roles heredados.
                    </div>
                }
            </div>
        </div>
              
        <div id="modal-dinamic-action-buttons" class="form-actions">
            <button class="btn btn-primary" onclick="operativaGestionMiembros.handleCambiarRolUsuario('@Model.IdentidadID')">@Html.GetText("COMMON", "ACEPTAR")</button>
        </div>
    </div>
</div>
