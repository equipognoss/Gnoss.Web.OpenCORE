@using System.Text
@model EstadoViewModel
@{
    EstadoViewModel estado = Model;
    string collapseId = $"panel_collapse_{Model.EstadoID.ToString().Substring(0, 5)}";
    string editores = Html.GetText("USUARIOS", "EDITORES");
    string tipoEstado = $"{Html.GetText("DEVTOOLS", "ESTADO")} ";
    switch (estado.TipoEstado)
    {
        case TipoEstado.Inicial:
            tipoEstado += Html.GetText("FLUJOS", "ESTADOINICIAL");
            break;
        case TipoEstado.Intermedio:
            tipoEstado += Html.GetText("FLUJOS", "ESTADOINTERMEDIO");
            break;
        case TipoEstado.Final:
            tipoEstado += Html.GetText("FLUJOS", "ESTADOFINAL");
            break;
    }

    List<string> titulosPrivacidad = new List<string> { Html.GetText("USUARIOS", "LECTORES"), $"{char.ToUpper(editores[0])}{editores.Substring(1)}" };

    StringBuilder htmlNombreLectores = new StringBuilder();
    StringBuilder htmlNombreEditores = new StringBuilder();
    foreach (EstadoIdentidadViewModel estadoIdentidad in estado.ListaEstadoIdentidad)
    {
        if (estadoIdentidad.Editor)
        {
            htmlNombreEditores.Append(PintarTags(estadoIdentidad.Nombre, estadoIdentidad.PerfilID, false));
        }
        else
        {
            htmlNombreLectores.Append(PintarTags(estadoIdentidad.Nombre, estadoIdentidad.PerfilID, false));
        }
    }

    foreach (EstadoGrupoViewModel estadoGrupo in estado.ListaEstadoGrupo)
    {
        if (estadoGrupo.Editor)
        {
            htmlNombreEditores.Append(PintarTags(estadoGrupo.Nombre, estadoGrupo.GrupoID, true));
        }
        else
        {
            htmlNombreLectores.Append(PintarTags(estadoGrupo.Nombre, estadoGrupo.GrupoID, true));
        }
    }

}
<div class="tag" data-id="@estado.EstadoID" title="@estado.Nombre">
    <div class="tag-wrap">
        <span class="tag-text">
            <span class="tag-label">@Html.ObtenerTextoIdiomaUsuario(estado.Nombre)<span class="tag-state">-@tipoEstado</span></span>
            <span class="users editors">
                <span class="user-label">@Html.GetText("USUARIOS", "EDITORES")</span>
                @Html.Raw(htmlNombreEditores.ToString())
            </span>
            <span class="users readers">
                <span class="user-label">@Html.GetText("USUARIOS", "LECTORES")</span>
                @Html.Raw(htmlNombreLectores.ToString())
            </span>
        </span>
        <span class="tag-edit material-icons">edit</span>
        <span class="tag-remove material-icons">delete</span>
    </div>
    <input type="hidden" data-tipo-estado="@((short)estado.TipoEstado)" data-estado-color="@estado.Color" data-estado-publico="@estado.Publico.ToString().ToLowerInvariant()" data-permite-mejora="@estado.PermiteMejora.ToString().ToLowerInvariant()" value="@estado.Nombre">
</div>
 
@functions{
    public string PintarTags(string pNombre, Guid pIdentidadID, bool pGrupo)
    {
        string resultado = "";
        resultado += $"<span data-grupo='{pGrupo.ToString().ToLowerInvariant()}' data-id='{pIdentidadID}'>{pNombre}</span>";
        return resultado;
    }
}